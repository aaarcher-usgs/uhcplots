<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Althea ArchMiller and John Fieberg" />

<meta name="date" content="2017-04-27" />

<title>Introduction to the Used-Habitat Calibration Plots (uhcplots) Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to the Used-Habitat Calibration Plots (uhcplots) Package</h1>
<h4 class="author"><em>Althea ArchMiller and John Fieberg</em></h4>
<h4 class="date"><em>2017-04-27</em></h4>



<p>This package contains functions that allow the user to:</p>
<ul>
<li><p>recreate the simulation examples in Fieberg, Forester, Street, Johnson, ArchMiller, and Matthiopoulos. In Review. Species distribution models: predictive snipers or shots in the dark? Ecology Letters.</p></li>
<li><p>create Used-Habitat Calibration (UHC) plots via cross-validation</p></li>
</ul>
<p>We begin by providing a short overview of the steps involved in creating UHC plots. We then illustrate the functions in the <em>uhcplots</em> package with a simple simulation example from Fieberg et al. (in review). Specifically, we show how UHC plots can be used to explore the impact of a missing predictor using data splitting.</p>
<p>Other vignettes illustrate how UHC plots can be used to:</p>
<ul>
<li>explore the impact of a missing predictor using spatially-stratified cross-validation</li>
<li>validate step-selection functions using a model fit to moose location data from Fieberg et al. (in review)</li>
</ul>
<div id="how-to-calculate-uhc-plots" class="section level2">
<h2>How to calculate UHC plots</h2>
<p>UHC plots are simple graphical tools that can be used to validate species distribution, habitat selection, and step-selection models. UCH plots compare distributions of habitat covariates at the used (or presence) points to distributions predicted based on a model fit to independent (training) data.</p>
<p>To create a UHC plot, we:</p>
<ol style="list-style-type: decimal">
<li><p>Split the data into training and test data sets. This may be accomplished by data splitting - either randomly or using temporal or spatial stratification (e.g., the model may be fit to a subset of sites or years, with other sites or years used as “out-of-sample” data). Alternatively, one can use bootstrapping or cross-validation to evaluate out-of-sample predictions. We provide an example using spatially-stratified cross-validation later on in this vignette.</p></li>
<li><p>Summarize the distribution of habitat covariates at the used (i.e., presence) points in the test data set, <span class="math inline">\(f^u(z)\)</span>. In our examples, we use a kernel density estimator to represent <span class="math inline">\(f^u(z)\)</span>. Similarly, summarize the distribution of the habitat covariates at the available (i.e., background) points in the test data set, <span class="math inline">\(f^a(z)\)</span>. Differences between these two densities signal that the covariate will be an important predictor of the species distribution.</p></li>
<li><p>Fit a model to the training data set. Store <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(\widehat{\mathrm{cov}}(\hat{\beta})\)</span> to characterize the uncertainty in the parameters (ignoring the intercept if using logistic regression). Assuming we have a large enough sample for <span class="math inline">\(\hat{\beta}\)</span> to be approximately normally distributed, we can draw samples from a multivariate normal distribution, <span class="math inline">\(\mathrm{MVN}(\hat{\beta}, \widehat{\mathrm{cov}}(\hat{\beta})\)</span>), to account for uncertainty in the estimated parameters. This uncertainty may alternatively be captured using a non-parametric bootstrap or via samples from a posterior distribution (if implementing the model in a Bayesian framework). We will refer to the distribution capturing uncertainty in <span class="math inline">\(\hat{\beta}\)</span> as the <em>joint parameter distribution</em> to recognize that this will be a multivariate distribution if more than one covariate is included in the model.</p></li>
<li><p>Do the following <span class="math inline">\(M\)</span> times (with loop index <span class="math inline">\(i\)</span>):</p>
<ol style="list-style-type: lower-alpha">
<li>To account for parameter uncertainty, select new vector of parameter values randomly from their joint parameter distribution, <span class="math inline">\(\beta^i\)</span>.</li>
<li>Estimate the relative probability of selection for the test data: <span class="math inline">\(w(x^{test}\beta^i)= \exp(x^{test}\beta^{i})\)</span>.</li>
<li>Select a simple random sample of <span class="math inline">\(n^{test}_u\)</span> observations from the combined (presence and background) test data, with probabilities of selection proportional to <span class="math inline">\(w(x^{test}\beta^i)\)</span> from step [3b]; here <span class="math inline">\(n^{test}_u\)</span> is the number of used points in the test data set.</li>
<li>Summarize the distribution of habitat covariates associated with the points chosen in step [3c], <span class="math inline">\(\hat{f}^u(z)_i\)</span> .</li>
</ol></li>
<li><p>Compare the observed distribution of covariate values at the presence points, <span class="math inline">\(f^u(z)\)</span> from step [1], to the predicted distribution of these characteristics, <span class="math inline">\(\hat{f}^u(z)_i\)</span> from step [3], across the <span class="math inline">\(M\)</span> simulations. We illustrate two plotting options:</p>
<ol style="list-style-type: lower-alpha">
<li>Option 1: overlay <span class="math inline">\(f^u(z)\)</span> (from step [1]) on a 95% simulation envelope constructed using the <span class="math inline">\(\hat{f}^u(z)_i\)</span>.</li>
<li>Option 2: plot the 2.5<span class="math inline">\(^{th}\)</span> and 97.5<span class="math inline">\(^{th}\)</span> quantiles of <span class="math inline">\(f^u(z)-\hat{f}^u(z)_i\)</span>.</li>
</ol></li>
</ol>
</div>
<div id="uhc-plots-to-explore-the-impact-of-a-missing-predictor-using-data-splitting" class="section level2">
<h2>UHC plots to explore the impact of a missing predictor using data splitting</h2>
<p>This simulation example comes from Fieberg et al. (in review). In this example, we will assume that the probability of selection is proportional to <span class="math inline">\(\exp(0.5x_1 - x_2)\)</span>, where <span class="math inline">\(x_1\)</span> is elevation and <span class="math inline">\(x_2\)</span> is precipitation. We begin by loading 2 packages:</p>
<ul>
<li>KernSmooth (for creating smooth density estimates of habitat covariates)</li>
<li>uchplots (for creating UHC plots!)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">library</span>(KernSmooth)
<span class="kw">library</span>(uhcplots)
<span class="kw">set.seed</span>(<span class="dv">1000</span>)</code></pre></div>
<p>We will simulate used and available pionts using the <em>uhcdatasimulator</em> function in the <em>uhcplots</em> package. This function was created to allow users to rerun the examples from Fieberg et al. (in review), but with the possibility of modifying:</p>
<ul>
<li>numbers of used and available locations in training and test data sets</li>
<li>the magnitude of the regression coefficients determining the relative probability of selection as a function of elevation and precipitation (example = “missing predictor”) or as a function of temperature and temperature<span class="math inline">\(^2\)</span> ( example = “non-linear”)</li>
<li>the correlation among elevation and precipitation in the test and training data sets (if running example = “missing predictor”)</li>
</ul>
<p>Below, we replicate the example illustrating UCH plots in the presence of a missing predictor (precipitation) for the scenario where the correlation between elevation and precipitation was = 0.3 in the training data and -0.3 in the test data.</p>
<p>Example-specific settings:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number of &quot;used&quot; locations</span>
nused_train &lt;-<span class="st"> </span>nused_test &lt;-<span class="st"> </span><span class="dv">100</span> 
<span class="co"># Number of &quot;available&quot; or background locations</span>
navail.train &lt;-<span class="st"> </span>navail.test &lt;-<span class="st"> </span><span class="dv">10000</span>
<span class="co"># Number of simulated available locations</span>
ntemp &lt;-<span class="st"> </span><span class="dv">1000000</span>
<span class="co"># Number of simulations used to create UHC plot (i.e., &quot;M&quot; from manuscript)</span>
nsims &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="co"># Example name</span>
example &lt;-<span class="st"> &quot;missing predictor&quot;</span>
<span class="co"># Example betas</span>
betas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, -<span class="dv">1</span>)
<span class="co"># Labels for x-axes</span>
xlabs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Elevation&quot;</span>,<span class="st">&quot;Precipitation&quot;</span>)</code></pre></div>
<p>Scenario-specific settings:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># correlation (elevation, precipitation) in training and test data</span>
corx.train &lt;-<span class="st"> </span><span class="fl">0.3</span>                    
corx.test &lt;-<span class="st"> </span>-<span class="fl">0.3</span>                    
<span class="co"># Plot labels (for the correlations, above)</span>
labcor1 &lt;-<span class="st"> </span><span class="kw">expression</span>(rho[<span class="kw">list</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>])]==<span class="fl">0.3</span>)
labcor2 &lt;-<span class="st"> </span><span class="kw">expression</span>(rho[<span class="kw">list</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>])]==-<span class="fl">0.3</span>) 
textplot &lt;-<span class="st"> &quot;&quot;</span>                    
<span class="co"># panel lables</span>
panlabs1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A)&quot;</span>,<span class="st">&quot;B)&quot;</span>)     
panlabs2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A)&quot;</span>,<span class="st">&quot;B)&quot;</span>, <span class="st">&quot;C)&quot;</span>, <span class="st">&quot;D)&quot;</span>)
<span class="co"># Add a title to the top if top &lt;-1</span>
top &lt;-<span class="st"> </span><span class="dv">1</span>                           </code></pre></div>
<p><strong>Simulate Data</strong></p>
<p>Simulate training data using the uhcdatasimulator() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">traindat &lt;-<span class="st"> </span><span class="kw">uhcdatasimulator</span>(<span class="dt">nused =</span> nused_train,
                             <span class="dt">navail =</span> navail.train,
                             <span class="dt">betas =</span> betas,
                             <span class="dt">corx =</span> corx.train,
                             <span class="dt">ntemp =</span> ntemp,
                             <span class="dt">example =</span> example)</code></pre></div>
<p>Simulate test data using the uhcdatasimulator() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">testdat &lt;-<span class="st"> </span><span class="kw">uhcdatasimulator</span>(<span class="dt">nused =</span> nused_test,
                             <span class="dt">navail =</span> navail.test,
                             <span class="dt">betas =</span> betas,
                             <span class="dt">corx =</span> corx.test,
                             <span class="dt">ntemp =</span> ntemp,
                             <span class="dt">example =</span> example)</code></pre></div>
<p><strong>Fit GLM Models to Training Data</strong></p>
<p>Now, we fit two models, one with both <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> (i.e., “correct” model) and one with just <span class="math inline">\(x_1\)</span> (i.e., “missing predictor” model).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correct model</span>
train.correct &lt;-<span class="st"> </span><span class="kw">glm</span>(y ~<span class="st"> </span>elev +<span class="st"> </span>precip,
                     <span class="dt">family =</span> binomial,
                     <span class="dt">data =</span> traindat)
<span class="co"># Missing predictor model</span>
train.missingprecip &lt;-<span class="st"> </span><span class="kw">glm</span>(y ~<span class="st"> </span>elev,
                           <span class="dt">family =</span> binomial,
                           <span class="dt">data =</span> traindat)</code></pre></div>
<p><strong>Create Predicted Distributions Using the <em>uhcsim</em> Function</strong></p>
<p>Next, we create simulation envelopes for the environmental characteristics (elevation and precipitation) at the observed locations in the test data using both models. As in the paper, we create 1000 predicted distributions (i.e., we set M = 1000 in step 4 of the process). Note, the <em>uhcim</em> function requires the following arguments:</p>
<ul>
<li>nsims = number of predicted distributions to create (this is analogous to “M” in step 4)</li>
<li>nused_test = number of used points to select in the test data set</li>
<li>xmat = design matrix for the fitted species distribution model</li>
<li>fit_rsf = fitted logistic regression model</li>
<li>z = matrix of habitat covariates to cross-validate.</li>
</ul>
<p>This function returns a (nsims, <span class="math inline">\(n^{u}_{test}\)</span>, number of covariates = ncol(z)) array containing the habitat covariates associated with each of <span class="math inline">\(n^{u}_{test}\)</span> randomly selected locations across all M simulations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correct model</span>
xhat.correct &lt;-<span class="st"> </span><span class="kw">uhcsim</span>(<span class="dt">nsims =</span> <span class="dv">1000</span>, 
                       <span class="dt">nused_test =</span> nused_test,
                       <span class="dt">xmat =</span> testdat[, <span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>,<span class="st">&quot;precip&quot;</span>)], 
                       <span class="dt">fit_rsf =</span> train.correct, 
                       <span class="dt">z =</span> testdat[, <span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>,<span class="st">&quot;precip&quot;</span>)])


<span class="co"># Missing predictor model</span>
xhat.missingprecip &lt;-<span class="st"> </span><span class="kw">uhcsim</span>(<span class="dt">nsims =</span> nsims, 
                             <span class="dt">nused_test =</span> nused_test, 
                             <span class="dt">xmat =</span> <span class="kw">as.matrix</span>(testdat[, <span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>)]), 
                             <span class="dt">fit_rsf =</span> train.missingprecip, 
                             <span class="dt">z =</span> testdat[, <span class="kw">c</span>(<span class="st">&quot;elev&quot;</span>,<span class="st">&quot;precip&quot;</span>)])</code></pre></div>
<p><strong>Summarize the Predicted Distributions Using the <em>uhcdenscalc</em> Function</strong></p>
<p>Next, we calculate a kernel density estimate of the predicted distribution of both predictors for each of the M data sets, <span class="math inline">\(\hat{f}^u(x_1)_i\)</span> and <span class="math inline">\(\hat{f}^u(x_2)_i\)</span> (<span class="math inline">\(i = 1, ..., M\)</span>). The <em>uhcdenscalc</em> function requires the following arguements:</p>
<ul>
<li>rand_sims = an (nsims, <span class="math inline">\(n^{u}_{test}\)</span>, number of covariates) array containing the habitat covariates associated with each of <span class="math inline">\(n^{u}_{test}\)</span> randomly selected locations across M separate simulations. Usually, this array will be generated by the <em>uhcsim</em> or <em>uhcsimstrat</em> function.</li>
<li>dat = the characteristics associated with observed locations in the test data set</li>
<li>avail = the characteristics associated with available locations in the test data set</li>
</ul>
<p>The <em>uhcdenscalc</em> function will return a list of density estimates associated with:</p>
<ul>
<li>all M sets of predicted locations (object$densrand);</li>
<li>the observed locations (object$densdat); and</li>
<li>the available locations (object$densavail)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correct model</span>
<span class="co"># uhcdenscalc function for both predictors</span>
denshats.elev.correct &lt;-<span class="st"> </span><span class="kw">uhcdenscalc</span>(<span class="dt">rand_sims =</span> xhat.correct[,,<span class="dv">1</span>],
                                  <span class="dt">dat =</span> <span class="kw">subset</span>(testdat, y==<span class="dv">1</span>, <span class="dt">select=</span><span class="st">&quot;elev&quot;</span>), 
                                  <span class="dt">avail =</span> <span class="kw">subset</span>(testdat, y==<span class="dv">0</span>, <span class="dt">select=</span><span class="st">&quot;elev&quot;</span>)) 
denshats.precip.correct &lt;-<span class="st"> </span><span class="kw">uhcdenscalc</span>(<span class="dt">rand_sims =</span> xhat.correct[,,<span class="dv">2</span>], 
                                     <span class="dt">dat =</span> <span class="kw">subset</span>(testdat, y==<span class="dv">1</span>, <span class="dt">select=</span><span class="st">&quot;precip&quot;</span>),
                                     <span class="dt">avail =</span> <span class="kw">subset</span>(testdat, 
                                                  y==<span class="dv">0</span>, <span class="dt">select=</span><span class="st">&quot;precip&quot;</span>)) 

<span class="co"># Missing predictor model</span>
<span class="co"># uhcdenscalc function for both predictors</span>
denshats.elev.missingprecip &lt;-<span class="st"> </span><span class="kw">uhcdenscalc</span>(<span class="dt">rand_sims =</span> xhat.missingprecip[,,<span class="dv">1</span>],
                                           <span class="dt">dat =</span> <span class="kw">subset</span>(testdat, 
                                                      y==<span class="dv">1</span>, <span class="dt">select=</span><span class="st">&quot;elev&quot;</span>), 
                                           <span class="dt">avail =</span> <span class="kw">subset</span>(testdat, 
                                                        y==<span class="dv">0</span>, <span class="dt">select=</span><span class="st">&quot;elev&quot;</span>)) 
denshats.precip.missingprecip &lt;-<span class="st"> </span><span class="kw">uhcdenscalc</span>(<span class="dt">rand_sims =</span> xhat.missingprecip[,,<span class="dv">2</span>], 
                                             <span class="dt">dat =</span> <span class="kw">subset</span>(testdat, 
                                                        y==<span class="dv">1</span>, <span class="dt">select=</span><span class="st">&quot;precip&quot;</span>), 
                                             <span class="dt">avail =</span> <span class="kw">subset</span>(testdat, 
                                                        y==<span class="dv">0</span>, <span class="dt">select=</span><span class="st">&quot;precip&quot;</span>))</code></pre></div>
<div id="create-uhc-plot-formatted-for-manuscript" class="section level3">
<h3>Create UHC plot (formatted for manuscript)</h3>
<p>Lastly, we use the <em>uhcdensplot</em> function to produce the UHC plot (as illustrated in Fieberg et al. in review). This function requires as input:</p>
<ul>
<li>densdat = the kernel density estimates of observed points in the test data set</li>
<li>densrand = the kernel density estimates for the habitat covariate at the predicted test data points (across M predicted data sets)</li>
<li>includeAvail = an indicator determining whether the distribution of the available locations should be drawn on the plot</li>
<li>densavail = the kernel density estimates of available points in the test data set (needed if includeAvail = TRUE)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>), <span class="dt">bty=</span><span class="st">&quot;L&quot;</span>)

<span class="co"># Use the first plot for text</span>
    <span class="kw">plot</span>(<span class="dv">1</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, 
         <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
         <span class="dt">xaxt=</span><span class="st">'n'</span>,<span class="dt">yaxt=</span><span class="st">'n'</span>,<span class="dt">bty=</span><span class="st">'n'</span>)
    <span class="kw">text</span>(<span class="fl">0.01</span>, <span class="fl">0.9</span>, <span class="st">&quot;Training Data&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>)
    <span class="kw">text</span>(<span class="fl">0.2</span>, <span class="fl">0.72</span>, labcor1 , <span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">adj=</span><span class="dv">0</span>) 
    <span class="kw">text</span>(<span class="fl">0.01</span>, <span class="fl">0.52</span>, <span class="st">&quot;Test Data&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>)
    <span class="kw">text</span>(<span class="fl">0.2</span>, <span class="fl">0.40</span>, labcor2 , <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>) 
    <span class="kw">legend</span>(<span class="fl">0.01</span>, <span class="fl">0.35</span>, <span class="kw">c</span>(<span class="st">&quot;Available&quot;</span>, <span class="st">&quot;Used&quot;</span>, <span class="st">&quot;Predicted&quot;</span>), 
            <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey&quot;</span>), 
            <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>))

<span class="co"># Incorrect model (missing predictor)</span>
<span class="kw">uhcdensplot</span>(<span class="dt">densdat =</span> denshats.elev.missingprecip$densdat, 
                <span class="dt">densrand =</span> denshats.elev.missingprecip$densrand,
                <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">4</span>,<span class="dv">9</span>),
                <span class="dt">includeAvail =</span> <span class="ot">TRUE</span>,
                <span class="dt">densavail =</span> denshats.elev.missingprecip$densavail,
            <span class="dt">includeLegend =</span> F) 
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>,  panlabs2[<span class="dv">1</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">1</span>], <span class="dt">cex=</span><span class="fl">1.0</span>)
    
    <span class="kw">uhcdensplot</span>(<span class="dt">densdat =</span> denshats.precip.missingprecip$densdat, 
            <span class="dt">densrand =</span> denshats.precip.missingprecip$densrand,
            <span class="dt">xl=</span><span class="kw">c</span>(-<span class="dv">9</span>,<span class="dv">6</span>),
            <span class="dt">includeAvail =</span> <span class="ot">TRUE</span>, 
            <span class="dt">densavail =</span> denshats.precip.missingprecip$densavail,
            <span class="dt">includeLegend =</span> F) 
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">2</span>], <span class="dt">cex=</span><span class="fl">1.0</span>)
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>, panlabs2[<span class="dv">2</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)

<span class="co"># Correct model (both predictors)</span>
<span class="kw">uhcdensplot</span>(<span class="dt">densdat =</span> denshats.elev.correct$densdat, 
            <span class="dt">densrand =</span> denshats.elev.correct$densrand,
            <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">5</span>,<span class="dv">9</span>),
            <span class="dt">includeAvail =</span> <span class="ot">TRUE</span>, 
            <span class="dt">densavail =</span> denshats.elev.correct$densavail,
            <span class="dt">includeLegend =</span> F)  
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>, panlabs2[<span class="dv">3</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">1</span>], <span class="dt">cex=</span><span class="fl">1.0</span>)

<span class="kw">uhcdensplot</span>(<span class="dt">densdat =</span> denshats.precip.correct$densdat, 
            <span class="dt">densrand =</span> denshats.precip.correct$densrand,
            <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">9</span>,<span class="fl">3.5</span>),
            <span class="dt">includeAvail =</span> <span class="ot">TRUE</span>, 
            <span class="dt">densavail =</span> denshats.precip.correct$densavail,
            <span class="dt">includeLegend =</span> F) 
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>, panlabs2[<span class="dv">4</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">2</span>], <span class="dt">cex=</span><span class="fl">1.0</span>)

    if(top==<span class="dv">1</span>){
      <span class="kw">mtext</span>(<span class="dt">outer=</span>T, <span class="dt">side=</span><span class="fl">3.5</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">adj=</span><span class="fl">0.80</span>, 
            <span class="kw">expression</span>(y %~%<span class="st"> </span>elev+precip), <span class="dt">cex=</span><span class="dv">1</span>)
      <span class="kw">mtext</span>(<span class="dt">outer=</span>T, <span class="dt">side=</span><span class="fl">3.5</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">adj=</span><span class="fl">0.40</span>, 
            <span class="kw">expression</span>(y %~%<span class="st"> </span>elev), <span class="dt">cex=</span><span class="dv">1</span>)
      }</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="alternative-uhc-plot" class="section level3">
<h3>Alternative UHC Plot</h3>
<p>We also illustrate an alternative plot, depicting the 2.5<span class="math inline">\(^{th}\)</span> and 97.5<span class="math inline">\(^{th}\)</span> quantiles of <span class="math inline">\(f^u(z)-\hat{f}^u(z)_i\)</span>, using the <em>uhcdiffdensplot</em> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>), <span class="dt">bty=</span><span class="st">&quot;L&quot;</span>)

<span class="co"># Use the first plot for text</span>
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, 
     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), 
     <span class="dt">xaxt=</span><span class="st">'n'</span>,<span class="dt">yaxt=</span><span class="st">'n'</span>,<span class="dt">bty=</span><span class="st">'n'</span>)
<span class="kw">text</span>(<span class="fl">0.01</span>, <span class="fl">0.9</span>, <span class="st">&quot;Training Data&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>)
<span class="kw">text</span>(<span class="fl">0.2</span>, <span class="fl">0.72</span>, labcor1 , <span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">adj=</span><span class="dv">0</span>) 
<span class="kw">text</span>(<span class="fl">0.01</span>, <span class="fl">0.52</span>, <span class="st">&quot;Test Data&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>)
<span class="kw">text</span>(<span class="fl">0.2</span>, <span class="fl">0.40</span>, labcor2 , <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">adj=</span><span class="dv">0</span>) 

<span class="co"># Incorrect model (missing predictor)</span>
<span class="kw">uhcdiffdensplot</span>(<span class="dt">densdat =</span> denshats.elev.missingprecip$densdat, 
                <span class="dt">densrand =</span> denshats.elev.missingprecip$densrand,
                <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">5</span>,<span class="dv">9</span>))  
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>,  panlabs2[<span class="dv">1</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">1</span>], <span class="dt">cex=</span><span class="dv">1</span>)

<span class="kw">uhcdiffdensplot</span>(<span class="dt">densdat =</span> denshats.precip.missingprecip$densdat, 
                    <span class="dt">densrand =</span> denshats.precip.missingprecip$densrand,
                    <span class="dt">xl=</span><span class="kw">c</span>(-<span class="dv">9</span>,<span class="fl">3.5</span>)) 
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">2</span>], <span class="dt">cex=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>, panlabs2[<span class="dv">2</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)

<span class="co"># Correct model (both predictors)</span>
<span class="kw">uhcdiffdensplot</span>(<span class="dt">densdat =</span> denshats.elev.correct$densdat, 
                    <span class="dt">densrand =</span> denshats.elev.correct$densrand,
                    <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">4</span>,<span class="dv">9</span>))  
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>,  panlabs2[<span class="dv">3</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">1</span>], <span class="dt">cex=</span><span class="dv">1</span>)

<span class="kw">uhcdiffdensplot</span>(<span class="dt">densdat =</span> denshats.precip.correct$densdat, 
                    <span class="dt">densrand =</span> denshats.precip.correct$densrand,
                    <span class="dt">xl =</span> <span class="kw">c</span>(-<span class="dv">9</span>,<span class="dv">6</span>))
    <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">line=</span><span class="dv">1</span>,  panlabs2[<span class="dv">4</span>], <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">ad=</span><span class="dv">0</span>)
    <span class="kw">mtext</span>(<span class="dt">outer=</span>F, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, xlabs[<span class="dv">2</span>], <span class="dt">cex=</span><span class="dv">1</span>)

if(top==<span class="dv">1</span>){
  <span class="kw">mtext</span>(<span class="dt">outer=</span>T, <span class="dt">side=</span><span class="fl">3.5</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">adj=</span><span class="fl">0.80</span>, 
        <span class="kw">expression</span>(y %~%<span class="st"> </span>elev+precip), <span class="dt">cex=</span><span class="dv">1</span>)
  <span class="kw">mtext</span>(<span class="dt">outer=</span>T, <span class="dt">side=</span><span class="fl">3.5</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">adj=</span><span class="fl">0.40</span>, 
        <span class="kw">expression</span>(y %~%<span class="st"> </span>elev), <span class="dt">cex=</span><span class="dv">1</span>)
}</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
